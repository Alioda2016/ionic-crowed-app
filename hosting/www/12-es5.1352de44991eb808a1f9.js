!function(){function e(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return n(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==o.return||o.return()}finally{if(s)throw i}}}}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{gC6i:function(n,o,a){"use strict";a.r(o),a.d(o,"SearchPlacePageModule",(function(){return C}));var i,c=a("ofXK"),s=a("3Pt+"),l=a("TEn/"),u=a("tyNb"),g=a("mrSG"),f=a("fXoL"),d=a("sSZD"),b=((i=function(){function e(n){t(this,e),this.db=n,this.crowedPercentageListRef=n.list("/crowdInformation")}return r(e,[{key:"createCrowedPercentage",value:function(e){return this.crowedPercentageListRef.push({name:e.name,crowedPercentage:e.crowdPercentage})}},{key:"getCrowedPercentage",value:function(e){return this.crowedPercentageRef=this.db.object("/crowdInformation/"+e),this.crowedPercentageRef}},{key:"getCrowedPercentageList",value:function(){return this.crowedPercentageListRef=this.db.list("/crowdInformation"),this.crowedPercentageListRef}},{key:"updateCrowedPercentage",value:function(e,n){return this.crowedPercentageRef.update({name:n.name,crowedPercentage:n.crowdPercentage})}},{key:"deleteCrowedPercentage",value:function(e){this.crowedPercentageRef=this.db.object("/crowdInformation/"+e),this.crowedPercentageRef.remove()}}]),e}()).\u0275fac=function(e){return new(e||i)(f.Pb(d.a))},i.\u0275prov=f.Eb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),m=a("5Px9"),h=["map"];function p(e,n){if(1&e){var t=f.Mb();f.Lb(0,"ion-item",15),f.Tb("click",(function(){f.bc(t);var e=n.$implicit;return f.Vb().showPlace(e.name)})),f.Lb(1,"ion-label"),f.Lb(2,"h2"),f.fc(3),f.Kb(),f.Kb(),f.Kb()}if(2&e){var o=n.$implicit;f.yb(3),f.gc(" ",o.name," ")}}var w,v,P,y=[{path:"",component:(w=function(){function n(e,o,r,a,i){t(this,n),this.router=e,this.alert=o,this.sharedService=r,this.maxPercentageService=a,this.db=i,this.infoWindows=[],this.searchedPlaces=[],this.showTabs=!1,this.data={name:"Kim Coffee",crowdPercentage:70},this.user={},this.markers=[{title:"kim's coffee",latitude:"21.481995210456603",longitude:"39.2382450551564"}]}return r(n,[{key:"ngOnInit",value:function(){var e=this;this.sharedService.getCrowedPercentageList().valueChanges().subscribe((function(n){console.log("res: ",n);var t=n[0].name,o=n[0].crowedPercentage;console.log("name",t),e.username=e.maxPercentageService.getUsername(),console.log("usename",e.username),e.maxPercentageService.getMaxPercentage(e.username).valueChanges().subscribe((function(n){var t;for(t in console.log("resss",n),n)console.log("key: ",t),t===e.username?(e.maxPercentage=n[t].max_percentage,console.log("max",e.maxPercentage)):"max_percentage"==t&&(e.maxPercentage=n.max_percentage,console.log("max",e.maxPercentage))})),o>=e.maxPercentage&&e.showAlert("Notification","crowd percentage in "+t+" now is: "+o)}))}},{key:"logOut",value:function(){this.ConfirmLogOutAlert("Confirm","You'r about to logout")}},{key:"search",value:function(e){var n=this,t=e.target.value.toLowerCase();t.length>0?this.db.database.ref("crowdInformation").orderByChild("name").startAt(t).endAt(t+"\uf8ff").once("value",(function(e){n.searchedPlaces=[],e.forEach((function(e){n.searchedPlaces.push(e.val()),console.log(n.searchedPlaces)}))})):(this.searchedPlaces=[],this.showMap(),this.showTabs=!this.showTabs)}},{key:"showPlace",value:function(e){console.log(e);var n=new google.maps.LatLng(21.481995210456603,39.2382450551564);this.map=new google.maps.Map(this.mapRef.nativeElement,{center:n,zoom:20,disableDefaultUI:!0}),this.addMarkersToMap(this.markers),this.showTabs=!this.showTabs}},{key:"ionViewDidEnter",value:function(){this.showMap()}},{key:"addMarkersToMap",value:function(n){var t,o=e(n);try{for(o.s();!(t=o.n()).done;){var r=t.value,a=new google.maps.LatLng(r.latitude,r.longitude),i=new google.maps.Marker({position:a,title:r.title,latitude:r.latitude,longitude:r.longitude});i.setMap(this.map),this.addInfoWindowToMarker(i)}}catch(c){o.e(c)}finally{o.f()}}},{key:"addInfoWindowToMarker",value:function(e){var n=this,t=new google.maps.InfoWindow({content:'<div id="content"><h2 id="firstHeading" class"firstHeading">'+e.title+"</h2><p>Latitude: "+e.latitude+"</p><p>Longitude: "+e.longitude+"</p></div>"});e.addListener("click",(function(){n.closeAllInfoWindows(),t.open(n.map,e)})),this.infoWindows.push(t)}},{key:"closeAllInfoWindows",value:function(){var n,t=e(this.infoWindows);try{for(t.s();!(n=t.n()).done;)n.value.close()}catch(o){t.e(o)}finally{t.f()}}},{key:"showMap",value:function(){var e=new google.maps.LatLng(21.481995210456603,39.2382450551564);this.map=new google.maps.Map(this.mapRef.nativeElement,{center:e,zoom:12,disableDefaultUI:!0})}},{key:"ConfirmLogOutAlert",value:function(e,n){return Object(g.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alert.create({cssClass:"my-custom-class",header:e,message:n,buttons:[{text:"OK",handler:function(){r.router.navigate(["home"])},cssClass:"alertButton"},{text:"Cancel"}]});case 2:return o=t.sent,t.next=5,o.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"navigate",value:function(){console.log("navigate button clicked!"),window.open("https://www.google.com/maps/dir/?api=1&destination="+this.markers[0].latitude+","+this.markers[0].longitude)}},{key:"setPercentage",value:function(){return Object(g.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alert.create({cssClass:"my-custom-class",header:"Please set maximum crowdedness percentage",inputs:[{name:"crowdPercentage",type:"number",placeholder:"percentage",cssClass:"alertInput"}],buttons:[{text:"Submit",handler:function(e){t.username=t.maxPercentageService.getUsername(),console.log(e),t.username&&t.maxPercentageService.addMaxPercentage(t.username,e.crowdPercentage).then((function(e){console.log(e)}),(function(e){console.log(e)}))}}]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"showAlert",value:function(e,n){return Object(g.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alert.create({cssClass:"my-custom-class",header:e,message:n,buttons:["Ok"]});case 2:return o=t.sent,t.next=5,o.present();case 5:case"end":return t.stop()}}),t,this)})))}}]),n}(),w.\u0275fac=function(e){return new(e||w)(f.Ib(u.g),f.Ib(l.a),f.Ib(b),f.Ib(m.a),f.Ib(d.a))},w.\u0275cmp=f.Cb({type:w,selectors:[["app-search-place"]],viewQuery:function(e,n){var t;1&e&&f.hc(h,!0,f.l),2&e&&f.Zb(t=f.Ub())&&(n.mapRef=t.first)},decls:25,vars:4,consts:[[3,"translucent"],["slot","start"],["animated","","placeholder","Search for place...","debounce","500",3,"ionChange"],["detail","","lines","full",3,"click",4,"ngFor","ngForOf"],["slot","end","size","small",3,"click"],["name","log-out-outline","size","small"],[3,"fullscreen"],["id","map"],["map",""],[3,"hidden"],["slot","bottom",1,"tabs"],["name","play-forward","size","small"],[3,"click"],["name","navigate","size","small"],["name","people","size","small"],["detail","","lines","full",3,"click"]],template:function(e,n){1&e&&(f.Lb(0,"ion-header",0),f.Lb(1,"ion-toolbar"),f.Lb(2,"ion-buttons",1),f.Jb(3,"ion-menu-button"),f.Kb(),f.Lb(4,"ion-searchbar",2),f.Tb("ionChange",(function(e){return n.search(e)})),f.Kb(),f.ec(5,p,4,1,"ion-item",3),f.Lb(6,"ion-button",4),f.Tb("click",(function(){return n.logOut()})),f.Jb(7,"ion-icon",5),f.Kb(),f.Kb(),f.Kb(),f.Lb(8,"ion-content",6),f.Jb(9,"div",7,8),f.Kb(),f.Lb(11,"ion-tabs",9),f.Lb(12,"ion-tab-bar",10),f.Lb(13,"ion-tab-button"),f.Jb(14,"ion-icon",11),f.Lb(15,"Strong"),f.fc(16,"Direction"),f.Kb(),f.Kb(),f.Lb(17,"ion-tab-button",12),f.Tb("click",(function(){return n.navigate()})),f.Jb(18,"ion-icon",13),f.Lb(19,"Strong"),f.fc(20,"Navigation"),f.Kb(),f.Kb(),f.Lb(21,"ion-tab-button",12),f.Tb("click",(function(){return n.setPercentage()})),f.Jb(22,"ion-icon",14),f.Lb(23,"Strong"),f.fc(24,"Percentage"),f.Kb(),f.Kb(),f.Kb(),f.Kb()),2&e&&(f.Yb("translucent",!1),f.yb(5),f.Yb("ngForOf",n.searchedPlaces),f.yb(3),f.Yb("fullscreen",!0),f.yb(3),f.Yb("hidden",!n.showTabs))},directives:[l.h,l.u,l.d,l.n,l.q,l.z,c.i,l.c,l.i,l.f,l.t,l.r,l.s,l.k,l.m],styles:["ion-toolbar[_ngcontent-%COMP%]{--background:#e66f51;margin-left:0}ion-button[_ngcontent-%COMP%]{margin-top:14px;--background:#e9c36a}.my-custom-class[_ngcontent-%COMP%]{--background:#63254e}ion-icon[_ngcontent-%COMP%]{color:#000}ion-searchbar[_ngcontent-%COMP%]{margin-left:0;margin-right:0;margin-top:10px}ion-item[_ngcontent-%COMP%], ion-searchbar[_ngcontent-%COMP%]{--background:#e9c36a;color:#000}ion-item[_ngcontent-%COMP%]{margin-right:10}#map[_ngcontent-%COMP%]{height:100%}#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:translucent}Strong[_ngcontent-%COMP%]{font-size:small;margin-bottom:auto}.tabs[_ngcontent-%COMP%], Strong[_ngcontent-%COMP%]{color:#941e30}.tabs[_ngcontent-%COMP%]{--background:#e66f51}"]}),w)}],k=((P=function e(){t(this,e)}).\u0275mod=f.Gb({type:P}),P.\u0275inj=f.Fb({factory:function(e){return new(e||P)},imports:[[u.i.forChild(y)],u.i]}),P),C=((v=function e(){t(this,e)}).\u0275mod=f.Gb({type:v}),v.\u0275inj=f.Fb({factory:function(e){return new(e||v)},imports:[[c.c,s.a,l.v,k]]}),v)}}])}();